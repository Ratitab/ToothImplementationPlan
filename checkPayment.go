package main

import (
	"encoding/json"
	"fmt"
	"net/http"
	"os"
)

type PaymentResponse struct {
	IsPaid bool `json:"isPaid"`
}

func (a *App) CheckPaymentStatus() (bool, error) {
	// fmt.Println("ramesmiketeeb?????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????")
	url := os.Getenv("LOCAL_URL") + "/check-payment-status"

	resp, err := http.Get(url)

	if err != nil {
		return false, err
	}

	defer resp.Body.Close()

	var paymentResponse PaymentResponse

	fmt.Println("[RESPONSEBODY]", resp.Body)

	if err := json.NewDecoder(resp.Body).Decode(&paymentResponse); err != nil {
		return false, err
	}
	fmt.Println("[PAYMENTSTATUS]", paymentResponse.IsPaid)
	return paymentResponse.IsPaid, nil
}
